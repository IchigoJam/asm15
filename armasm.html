<!DOCTYPE html><html><head><meta charset="utf-8">
<title>Cortex-M0 Armマシン語表 （asm15表記、抜粋）</title>
<meta property="og:image" content="armasm.png">
<link rel="apple-touch-icon" href="armasm.png"/>
<script src=lib/maketable2.js></script>
<style>
body {
	font-family: sans-serif;
}
.tarmasm {
	border-collapse: collapse;
	page-break-inside: avoid;
}
.tarmasm th {
	width: 2em;
	border: 1px solid black;
	font-size: 92%;
}
.tarmasm {
	margin-top: .5em;
}
.tarmasm th:first-child {
	width: 10em;
	text-align: left;
	border: none;
}
.tarmasm td {
	text-align: center;
	font-size: 92%;
	border: 1px solid black;
}
.tarmasm td:first-child {
	text-align: left;
	padding-left: 3px;
	border: 1px solid black;
}
a {
	color: gray !important;
}
</style>
</head><body>

<h1>Cortex-M0 Armマシン語表 （asm15表記、抜粋）</h1>

<table id="t1188a" class=tarmasm></table>
<script>
makeTable("t1188a", function() {/*
代入	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
Rd = u8	0	0	1	0	0	Rd			u8								1
Rd = Rm	0	1	0	0	0	1	1	0	Rd3	Rm				Rd2-0			1|3
*/})
</script>
※Rd3とRd2-0の4bitでRdを指定する、RdがPCの時3cycles

<table id="t1188b" class=tarmasm></table>
<script>
makeTable("t1188b", function() {/*
演算	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
Rd += u8	0	0	1	1	0	Rd			u8								1
Rd = Rn + u3	0	0	0	1	1	1	0	u3			Rn			Rd			1
Rd = Rn + Rm	0	0	0	1	1	0	0	Rm			Rn			Rd			1
Rd += Rm	0	1	0	0	0	1	0	0	Rd3	Rm				Rd2-0			1|3
Rd = PC + u8	1	0	1	0	0	Rd			u8/4								1
Rd -= u8	0	0	1	1	1	Rd			u8								1
Rd = Rn - u3	0	0	0	1	1	1	1	u3			Rn			Rd			1
Rd = Rn - Rm	0	0	0	1	1	0	1	Rm			Rn			Rd			1
Rd = -Rm	0	1	0	0	0	0	1	0	0	1	Rm			Rd			1
Rd *= Rm	0	1	0	0	0	0	1	1	0	1	Rm			Rd			1
Rd = Rm &lt;&lt; u5	0	0	0	0	0	u5					Rm			Rd			1
Rd &lt;&lt;= Rm	0	1	0	0	0	0	0	0	1	0	Rm			Rd			1
Rd = Rm &gt;&gt; u5	0	0	0	0	1	u5					Rm			Rd			1
Rd &gt;&gt;= Rm	0	1	0	0	0	0	0	0	1	1	Rm			Rd			1
Rd = ~Rm	0	1	0	0	0	0	1	1	1	1	Rm			Rd			1
Rd &amp;= Rm	0	1	0	0	0	0	0	0	0	0	Rm			Rd			1
Rd |= Rm	0	1	0	0	0	0	1	1	0	0	Rm			Rd			1
Rd ^= Rm	0	1	0	0	0	0	0	0	0	1	Rm			Rd			1
*/})
</script>
※Rd3とRd2-0の4bitでRdを指定する、Rd=PCの時3cycles

<table id="t1479a" class=tarmasm></table>
<script>
makeTable("t1479a", function() {/*
メモリアクセス	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
Rd = [Rn + u5]	0	1	1	1	1	u5					Rn			Rd			2
Rd = [Rn + u5]W	1	0	0	0	1	u5/2					Rn			Rd			2
Rd = [Rn + u5]L	0	1	1	0	1	u5/4					Rn			Rd			2
Rd = [PC + u8]L	0	1	0	0	1	Rd			u8/4								2
Rd = [Rn + Rm]	0	1	0	1	1	1	0	Rm			Rn			Rd			2
Rd = [Rn + Rm]C	0	1	0	1	0	1	1	Rm			Rn			Rd			2
Rd = [Rn + Rm]W	0	1	0	1	1	0	1	Rm			Rn			Rd			2
Rd = [Rn + Rm]S	0	1	0	1	1	1	1	Rm			Rn			Rd			2
Rd = [Rn + Rm]L	0	1	0	1	1	0	0	Rm			Rn			Rd			2
[Rn + u5] = Rd	0	1	1	1	0	u5					Rn			Rd			2
[Rn + u5]W = Rd	1	0	0	0	0	u5/2					Rn			Rd			2
[Rn + u5]L = Rd	0	1	1	0	0	u5/4					Rn			Rd			2
[Rn + Rm] = Rd	0	1	0	1	0	1	0	Rm			Rn			Rd			2
[Rn + Rm]W = Rd	0	1	0	1	0	0	1	Rm			Rn			Rd			2
[Rn + Rm]L = Rd	0	1	0	1	0	0	0	Rm			Rn			Rd			2
*/})
</script>
※[]後の記号でメモリサイズと符号を表す（W:2byte、L:4byte、C:符号付き1byte、S:符号付き2byte）

<table id="t1188c" class=tarmasm></table>
<script>
makeTable("t1188c", function() {/*
条件判断	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
Rn - u8	0	0	1	0	1	Rn			u8								1
Rn - Rm	0	1	0	0	0	1	0	1	Rn3	Rm				Rn2-0			1
Rn - Rm	0	1	0	0	0	0	1	0	1	0	Rm			Rn			1
Rn + Rm	0	1	0	0	0	0	1	0	1	1	Rm			Rn			1
Rn &amp; Rm	0	1	0	0	0	0	1	0	0	0	Rm			Rn			1
*/})
</script>
※Rn3とRn2-0の4bitでRnを指定する

<table id="t1188d" class=tarmasm></table>
<script>
makeTable("t1188d", function() {/*
分岐	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
IF 0 GOTO n8 &lt;&lt; 1	1	1	0	1	0	0	0	0	n8								1|3
IF !0 GOTO n8 &lt;&lt; 1	1	1	0	1	0	0	0	1	n8								1|3
GOTO n11 &lt;&lt; 1	1	1	1	0	0	n11											3
GOTO Rm	0	1	0	0	0	1	1	1	0	Rm				0	0	0	3
GOSUB Rm	0	1	0	0	0	1	1	1	1	Rm				0	0	0	3
GOSUB n22 &lt;&lt; 1	1	1	1	1	0	n22(21-11)											1
-	1	1	1	1	1	n22(10-0)											3
RET (=#4770)	0	1	0	0	0	1	1	1	0	1	1	1	0	0	0	0	3
*/})
/*
本来はn24だけど、n22としておく、n22からn24に拡張された後がある
CALL n24 &lt;&lt; 1	1	1	1	1	0	S	n24(20-11)										-
-	1	1	J1	1	J2	n24(10-0)											4
*/
</script>
※指定する値(n8,n11,n22)は飛び先との命令数差分から-2した数を指定、分岐するとき3cycles<br>

<table id="t1479b" class=tarmasm></table>
<script>
makeTable("t1479b", function() {/*
スタック	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
PUSH {regs}	1	0	1	1	0	1	0	LR	R7	R6	R5	R4	R3	R2	R1	R0	1+N
POP {regs}	1	0	1	1	1	1	0	PC	R7	R6	R5	R4	R3	R2	R1	R0	1|4+N
SP += u7	1	0	1	1	0	0	0	0	0	u7/4							1
SP -= u7	1	0	1	1	0	0	0	0	1	u7/4							1
Rd = SP + u8	1	0	1	0	1	Rd			u8/4								1
Rd = [SP + u8]L	1	0	0	1	1	Rd			u8/4								2
[SP + u8]L = Rd	1	0	0	1	0	Rd			u8/4								2
*/})
</script>
※PUSH: SPへregsの大きいレジスタから順に積みSPを減らす 例）PUSH {R1,R2}<br>
※POP: SPからregsの小さいレジスタから順に読み込みSPを増やす 例）POP {R1,R2}<br>
※N:指定したレジスタの数、PCへPOPした場合4+Ncycles（それ以外は1+Ncycles）<br>

<table id="t1188b2" class=tarmasm></table>
<script>
makeTable("t1188b2", function() {/*
特殊演算	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
Rd = bic(Rd, Rm)	0	1	0	0	0	0	1	1	1	0	Rm			Rd			1
Rd = asr(Rm, u5)	0	0	0	1	0	u5					Rm			Rd			1
Rd = asr(Rd, Rm)	0	1	0	0	0	0	0	1	0	0	Rm			Rd			1
Rd = ror(Rd, Rm)	0	1	0	0	0	0	0	1	1	1	Rm			Rd			1
Rd = rev(Rm)	1	0	1	1	1	0	1	0	0	0	Rm			Rd			1
Rd = rev16(Rm)	1	0	1	1	1	0	1	0	0	1	Rm			Rd			1
Rd = revSH(Rm)	1	0	1	1	1	0	1	0	1	1	Rm			Rd			1
Rd = adc(Rd, Rm)	0	1	0	0	0	0	0	1	0	1	Rm			Rd			1
Rd = sbc(Rd, Rm)	0	1	0	0	0	0	0	1	1	0	Rm			Rd			1
*/})
</script>
※bic:ビットクリア、asr:符号付き右シフト、ror:右ローテート<br>
※rev:byteオーダー反転、rev16:byteオーダー反転(2byteずつ)、revSH:符号付き16bitを反転32bit化<br>
※abc:キャリー付き足し算、sbc:キャリー付き引き算<br>

<table id="t1479d" class=tarmasm></table>
<script>
makeTable("t1479d", function() {/*
マルチメモリアクセス	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
LDM Rn, {regs}	1	1	0	0	1	Rn			R7	R6	R5	R4	R3	R2	R1	R0	1+N
STM Rn, {regs}	1	1	0	0	0	Rn			R7	R6	R5	R4	R3	R2	R1	R0	1+N
*/})
</script>
※LDM: アドレスRnからregsの小さいレジスタから順に読み込みRnを進める 例）LDM R0,{R1,R2}<br>
※STM: アドレスRnへregsの小さいレジスタから順に書き込みRnを進める 例）LDM R0,{R1,R2}<br>
※N:指定したレジスタの数<br>

<table id="t1479c" class=tarmasm></table>
<script>
makeTable("t1479c", function() {/*
その他	15	14	13	12	11	10	9	8	7	6	5	4	3	2	1	0	cycles
NOP (=0)	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1
CPSID (=#B672)	1	0	1	1	0	1	1	0	0	1	1	1	0	0	1	0	1
CPSIE (=#B662)	1	0	1	1	0	1	1	0	0	1	1	0	0	0	1	0	1
WFI (=#BF30)	1	0	1	1	1	1	1	1	0	0	1	1	0	0	0	0	2
*/})
</script>
※CPSID:割込禁止、CPSIE:割込許可、WFI:割込待ち、NOP:なにもしない(no operation) R0=R0<<0

		<br>
<!--
todo
分岐の種類を増やす

		符号拡張を追加
		SXTB(8), SXTH(16), UXTB(8), UXTH(16) -- extend to 32bit
		
		データバリアを追加
		DMB(t2), DSB(t2), ISB(t2) -- data barrier
		
		特殊アドレスを追加
		MRS(t2) 特殊アドレス読込, MSR(t2) 特殊アドレスへ書き込み
			APSR IAPSR EAPSR XPSR IPSR EPSR IEPSR MSP PSP PRIMASK CONTROL
		
		その他命令
		デバッグ用
		BKPT -- break point
		スーパーバイザーコール（割込？）
		SVC -- supervisor call

		YIELD, 
		
		SEV -- send event
		WFE -- wait for event
		
		CPS -- change processor state CPSID/CPSIE
		WFI -- wait for interrupt
		NOP, 
-->
</p><p>
- マシン語関連ツール<br>
<a href=index.html>asm15</a> - Assembler for IchigoJam<br>
<a href=cpuemu.html>cpuemu15</a> - IchigoJam マシン語エミュレーター alpha1 (<a href="http://fukuno.jig.jp/1328">説明</a>)<br>
</p><p>
- 連載、IchigoJamではじめる、Armマシン語入門<br>
<a href=http://fukuno.jig.jp/1184>1. はじめてのマシン語</a><br>
<a href=http://fukuno.jig.jp/1186>2. ハンドアセンブルで超速計算！</a><br>
<a href=http://fukuno.jig.jp/1188>3. マシン語メモリアクセスで画面超速表示！</a><br>
<a href=http://fukuno.jig.jp/1476>4. マシン語でLEDを光らせよう！</a><br>
<a href=http://fukuno.jig.jp/1479>5. 楽しさ広がるマルチバイトメモリアクセスとスタック</a><br>
<a href=http://fukuno.jig.jp/1484>6. マシン語使いこなしTIPS</a><br>
<a href=http://fukuno.jig.jp/1485>7. カジュアルに使うインラインマシン語</a><br>
<a href=http://fukuno.jig.jp/1757>8. アセンブラを使って楽しよう</a><br>
<a href=http://fukuno.jig.jp/1849>9. マシン語で高速SPI</a><br>
<a href=http://fukuno.jig.jp/1872>10. マシン語を制するもの時間を制す</a><br>
<a href=http://fukuno.jig.jp/1889>11. 画面をイチゴで埋め尽くす12の方法</a><br>
<!--
クロックを意識して特殊演算
	4byte rotate
条件分岐キャリー
まとめてload/store
関数（除算）
-->

</p><p>
DATA: <a href=https://www.arm.com/ja/products/processors/cortex-m/cortex-m0.php>Cortex-M0プロセッサ - Arm</a> (<a href=http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0432c/CHDCICDF.html>cycles</a>)<br>
Text: CC BY <a href=http://ichigojam.net/>ichigojam.net</a><br>

</body></html>